import os

# get root absolute path /PATH/TO/CHASS/
ROOT_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
# os.path.abspath(__file__) 获取当前文件路径
# os.getcwd() 获取当前工作路径

CURRENT_P_VALUE = "p-value_1e-5" # 这里的p-value是指FIMO在hg38中扫描CTCF motif采用了阈值p-value
BEDPE_PATH = ROOT_DIR+'/data/ChIA-PET/CTCF/bedpe/{}.e500.clusters.cis.BE3'
FIMO_RESULT_PATH = ROOT_DIR+r"/data/FIMO_result/MA1929.1_reverse_hg38_FIMO_result/"+CURRENT_P_VALUE+"/"
FIMO_CUSTOMISED_RESULT_PATH = ROOT_DIR+"/data/FIMO_result/MA1929.1{}_hg38_FIMO_result/"+CURRENT_P_VALUE+"/FIMO_filtered_sorted.tsv"
BEDPE_FILTERED_PATH = ROOT_DIR+r'/data/ChIA-PET/CTCF/bedpe_filtered/MA1929.1/'+CURRENT_P_VALUE+'/{}.filtered.e500.clusters.cis.BE3'
# MOTIF_ON_ANCHOR_PATH = ROOT_DIR+r'/data/ChIA-PET/CTCF/bedpe_filtered/MA1929.1/'+CURRENT_P_VALUE+'/{}.pos_motif' # file path: CTCF motif overlaps with positive loop
MOTIF_ON_ANCHOR_PATH = ROOT_DIR+r'/data/ChIA-PET2_result/'+'{}_ChIA-PET2_result/{}.pos_motif'
NEGATIVE_MOTIF_PATH = ROOT_DIR+r'/data/negative_motif/'+'/{}.neg_motif'
CHIA_PET2_RESULT_PATH = ROOT_DIR+r'/data/ChIA-PET2_result/'+'{}_ChIA-PET2_result/'
DNASE_DIR = ROOT_DIR+r"/data/DNase/"
CHROM_SIZES = ROOT_DIR+r"/data/hg38/hg38.chrom.sizes"
NON_MOTIF_PATH = ROOT_DIR+r'/data/negative_motif/'+'/{}.non_motif'
NEG_LOOP_PATH = ROOT_DIR+r'/data/negative_loop/'+'/{}.type_{}.subset_{}.neg_loop'
POS_LOOP_PATH = ROOT_DIR+r'/data/positive_loop/'+'/{}.type_{}.pos_loop'
GLOVE_PATH = ROOT_DIR+r'/source/pretrained_model/pytorch_glove/'
PRETRAINED_DATA_PATH = ROOT_DIR+r'/data/pretrained_data/'
CHIP_SEQ_PATH = ROOT_DIR+r'/data/ChIP-seq/'
PRETRAINED_MODEL_PATH = ROOT_DIR+r'/source/pretrained_model/'
FINE_TUNED_ANCHOR_MODEL_PATH = ROOT_DIR+r'/source/fine_tuned_anchor_model/'
FINE_TUNED_OCR_MODEL_PATH = ROOT_DIR+r'/source/fine_tuned_ocr_model/'
LOOP_MODEL_PATH = ROOT_DIR+r'/source/loop_model/'
CONSERVATION_PATH = ROOT_DIR+r'/data/phastcons/'


CHROMOSOME_LIST = ['chr1',  'chr2',  'chr3',
                   'chr4',  'chr5',  'chr6',
                   'chr7',  'chr8',  'chr9',
                   'chr10', 'chr11', 'chr12',
                   'chr13', 'chr14', 'chr15',
                   'chr16', 'chr17', 'chr18',
                   'chr19', 'chr20', 'chr21',
                   'chr22', 'chrX',  'chrY']

CHROMOSOME_DICT =  {'chr1' :r'NC_000001.11', 'chr2' :r'NC_000002.12', 'chr3' :r'NC_000003.12',\
                    'chr4' :r'NC_000004.12', 'chr5' :r'NC_000005.10', 'chr6' :r'NC_000006.12',\
                    'chr7' :r'NC_000007.14', 'chr8' :r'NC_000008.11', 'chr9' :r'NC_000009.12',\
                    'chr10':r'NC_000010.11', 'chr11':r'NC_000011.10', 'chr12':r'NC_000012.12',\
                    'chr13':r'NC_000013.11', 'chr14':r'NC_000014.9' , 'chr15':r'NC_000015.10',\
                    'chr16':r'NC_000016.10', 'chr17':r'NC_000017.11', 'chr18':r'NC_000018.10',\
                    'chr19':r'NC_000019.10', 'chr20':r'NC_000020.11', 'chr21':r'NC_000021.9' ,\
                    'chr22':r'NC_000022.11', 'chrX' :r'NC_000023.11', 'chrY' :r'NC_000024.10', 'chrMT':r'NC_012920.1'}

# MOTIF MA0139.1 CTCF
# URL http://jaspar.genereg.net/matrix/MA0139.1
# ALPHABET= ACGT
CTCF_PWM_INDEX = {'A':0, "C":1, "G":2, "T":3}
CTCF_PWM = [[0.095290, 0.318729, 0.083242, 0.502738],
            [0.182913, 0.158817, 0.453450, 0.204819],
            [0.307777, 0.053669, 0.491785, 0.146769],
            [0.061336, 0.876232, 0.023001, 0.039430],
            [0.008762, 0.989047, 0.000001, 0.002191],
            [0.814896, 0.014239, 0.071194, 0.099671],
            [0.043812, 0.578313, 0.365827, 0.012048],
            [0.117325, 0.474781, 0.052632, 0.355263],
            [0.933114, 0.012061, 0.035088, 0.019737],
            [0.005488, 0.000001, 0.991218, 0.003293],
            [0.365532, 0.003293, 0.621295, 0.009879],
            [0.059276, 0.013172, 0.553238, 0.374314],
            [0.013187, 0.000001, 0.978022, 0.008791],
            [0.061538, 0.008791, 0.851648, 0.078022],
            [0.114411, 0.806381, 0.005501, 0.073707],
            [0.409241, 0.014301, 0.557756, 0.018702],
            [0.090308, 0.530837, 0.338106, 0.040749],
            [0.128855, 0.354626, 0.080396, 0.436123],
            [0.442731, 0.199339, 0.292952, 0.064978]]
CTCF_PWM_REVERSE = [[0.442731, 0.199339, 0.292952, 0.064978],
                    [0.128855, 0.354626, 0.080396, 0.436123],
                    [0.090308, 0.530837, 0.338106, 0.040749],
                    [0.409241, 0.014301, 0.557756, 0.018702],
                    [0.114411, 0.806381, 0.005501, 0.073707],
                    [0.061538, 0.008791, 0.851648, 0.078022],
                    [0.013187, 0.000001, 0.978022, 0.008791],
                    [0.059276, 0.013172, 0.553238, 0.374314],
                    [0.365532, 0.003293, 0.621295, 0.009879],
                    [0.005488, 0.000001, 0.991218, 0.003293],
                    [0.933114, 0.012061, 0.035088, 0.019737],
                    [0.117325, 0.474781, 0.052632, 0.355263],
                    [0.043812, 0.578313, 0.365827, 0.012048],
                    [0.814896, 0.014239, 0.071194, 0.099671],
                    [0.008762, 0.989047, 0.000001, 0.002191],
                    [0.061336, 0.876232, 0.023001, 0.03943],
                    [0.307777, 0.053669, 0.491785, 0.146769],
                    [0.182913, 0.158817, 0.45345, 0.204819],
                    [0.09529, 0.318729, 0.083242, 0.502738]]
# MOTIF MA1929.1 CTCF
# URL http://jaspar.genereg.net/matrix/MA1929.1
# TF has several motif variants. Extended motif with zinc finger 8 (5bp)
CTCF_ZF_PWM =  [[0.133757, 0.567396, 0.182530, 0.116317],
                [0.135087, 0.059858, 0.047148, 0.757907],
                [0.024091, 0.019509, 0.924032, 0.032368],
                [0.042418, 0.808158, 0.035619, 0.113804],
                [0.673810, 0.092669, 0.057641, 0.175879],
                [0.245049, 0.170706, 0.490984, 0.093260],
                [0.087496, 0.145729, 0.084393, 0.682383],
                [0.167455, 0.114839, 0.262046, 0.455661],
                [0.106414, 0.587201, 0.112918, 0.193467],
                [0.114543, 0.578333, 0.080402, 0.226722],
                [0.303725, 0.273574, 0.168637, 0.254064],
                [0.217706, 0.283033, 0.307272, 0.191989],
                [0.242241, 0.341117, 0.212977, 0.203665],
                [0.289536, 0.208691, 0.211203, 0.290570],
                [0.231895, 0.211499, 0.323973, 0.232634],
                [0.122229, 0.365061, 0.139226, 0.373485],
                [0.219184, 0.205735, 0.335353, 0.239728],
                [0.243719, 0.116908, 0.465859, 0.173515],
                [0.107892, 0.749039, 0.076559, 0.066509],
                [0.033107, 0.934230, 0.011676, 0.020987],
                [0.633018, 0.052764, 0.138191, 0.176027],
                [0.063996, 0.524830, 0.366982, 0.044192],
                [0.184895, 0.406148, 0.091339, 0.317617],
                [0.770322, 0.036063, 0.116317, 0.077298],
                [0.031038, 0.016849, 0.943985, 0.008129],
                [0.368608, 0.012711, 0.603754, 0.014928],
                [0.073160, 0.037541, 0.515371, 0.373928],
                [0.034289, 0.011233, 0.934969, 0.019509],
                [0.051286, 0.056311, 0.798995, 0.093408],
                [0.152823, 0.696867, 0.036358, 0.113952],
                [0.404523, 0.068874, 0.455808, 0.070795],
                [0.103754, 0.490984, 0.292640, 0.112622],
                [0.171593, 0.342448, 0.119273, 0.366686],
                [0.336240, 0.253030, 0.297813, 0.112918]]
CTCF_ZF_PWM_REVERSE =  [[0.33624, 0.25303, 0.297813, 0.112918],
                        [0.171593, 0.342448, 0.119273, 0.366686],
                        [0.103754, 0.490984, 0.29264, 0.112622],
                        [0.404523, 0.068874, 0.455808, 0.070795],
                        [0.152823, 0.696867, 0.036358, 0.113952],
                        [0.051286, 0.056311, 0.798995, 0.093408],
                        [0.034289, 0.011233, 0.934969, 0.019509],
                        [0.07316, 0.037541, 0.515371, 0.373928],
                        [0.368608, 0.012711, 0.603754, 0.014928],
                        [0.031038, 0.016849, 0.943985, 0.008129],
                        [0.770322, 0.036063, 0.116317, 0.077298],
                        [0.184895, 0.406148, 0.091339, 0.317617],
                        [0.063996, 0.52483, 0.366982, 0.044192],
                        [0.633018, 0.052764, 0.138191, 0.176027],
                        [0.033107, 0.93423, 0.011676, 0.020987],
                        [0.107892, 0.749039, 0.076559, 0.066509],
                        [0.243719, 0.116908, 0.465859, 0.173515],
                        [0.219184, 0.205735, 0.335353, 0.239728],
                        [0.122229, 0.365061, 0.139226, 0.373485],
                        [0.231895, 0.211499, 0.323973, 0.232634],
                        [0.289536, 0.208691, 0.211203, 0.29057],
                        [0.242241, 0.341117, 0.212977, 0.203665],
                        [0.217706, 0.283033, 0.307272, 0.191989],
                        [0.303725, 0.273574, 0.168637, 0.254064],
                        [0.114543, 0.578333, 0.080402, 0.226722],
                        [0.106414, 0.587201, 0.112918, 0.193467],
                        [0.167455, 0.114839, 0.262046, 0.455661],
                        [0.087496, 0.145729, 0.084393, 0.682383],
                        [0.245049, 0.170706, 0.490984, 0.09326],
                        [0.67381, 0.092669, 0.057641, 0.175879],
                        [0.042418, 0.808158, 0.035619, 0.113804],
                        [0.024091, 0.019509, 0.924032, 0.032368],
                        [0.135087, 0.059858, 0.047148, 0.757907],
                        [0.133757, 0.567396, 0.18253, 0.116317]]

# the 22 cell lines in this project
# old version:
# old version: CELL_LINE_LIST = ['A549', 'A673', 'AG04449', 'AG04450', 'BJ',
# old version:                   'Caco-2', 'GM10248', 'GM12878', 'H1', 'HCT116',
# old version:                   'HepG2', 'IMR-90', 'K562', 'MCF-10A', 'MCF-7',
# old version:                   'OCI-LY7', 'PC-3', 'PC-9', 'Panc1', 'RWPE1',
# old version:                   'SK-N-SH', 'WTC11']
CELL_LINE_LIST = ['A549', 'A673', 'AG04449', 'AG04450', 'BJ',
                  'Caco-2', 'GM10248', 'GM12878', 'HCT116',
                  'HepG2', 'IMR-90', 'K562', 'MCF-10A', 'MCF-7',
                  'OCI-LY7', 'PC-3', 'PC-9', 'Panc1', 'RWPE1',
                  'SK-N-SH']

RANDOM_SEED = 9523

'''
below is gnn parameters
'''
TRAIN_SET_RATIO = 0.8


