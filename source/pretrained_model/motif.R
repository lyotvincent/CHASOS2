local({r <- getOption("repos")  
r["CRAN"] <- "https://mirrors.tuna.tsinghua.edu.cn/CRAN/"   
options(repos=r)}) 

# install.packages("ggseqlogo")
# install.packages("rlang")
# install.packages("ggplot2")
# library(ggplot2)
library(ggseqlogo)
# data(ggseqlogo_sample)
# head(pfms_dna)[1]
# # p1 = ggseqlogo( pfms_dna$MA0018.2 )
# p1 = ggseqlogo( pfms_dna[2])
# p1

# # Plot a single DNA sequence logo
# p1 = ggseqlogo( seqs_dna[[1]] )
# p1

# mydata = matrix( c(0.2451321630073189, 0.24356695602573886, 0.2455609410731911, 0.24303353371142924, 0.2337751848274832, 0.23901265018788964, 0.23285494573213933, 0.22672512123929583, 0.22371765509876643, 0.22637382199980186, 0.2159658155977617, 0.2160725711612328, 0.21827678020674077, 0.21801216841315846, 0.21453489129751152, 0.21495595437714557, 0.21489309599694073, 0.21596417797797446, 0.22424356102362858, 0.21835683684592003, 0.2172896500511662, 0.2195616982643993, 0.22238302898023957, 0.23163458574359194, 0.227570031685336, 0.2306996476122155, 0.23575698350431268, 0.23336718931421585, 0.233676878516961, 0.2364856591418365, 0.2500356875143474, 0.24676429654418755, 0.24634107285328763, 0.261155154146588, 0.23665806544368312, 0.23902354915381105, 0.23838799856538387, 0.23207467418602606, 0.2336090907178388, 0.22451608245027663, 0.22154325512608455, 0.21224675784512276, 0.20813573556798523, 0.21151263781484317, 0.21559202886196907, 0.21343103214876386, 0.21408403465541798, 0.21962406863855538, 0.22235901860456234, 0.21885335788205548, 0.21552094384637094, 0.22182870079812197, 0.21614497478488037, 0.21763033530514636, 0.2212757584661699, 0.22914495116598896, 0.23448882579744948, 0.2298028861567692, 0.2324974529336771, 0.2403471988052949, 0.24082046591175413, 0.24450818676169359, 0.24550516261472258, 0.23908935490518632, 0.2364034536377573, 0.23899672460185525, 0.248226927526603, 0.2417207812198104, 0.28536913900525873, 0.26946468006568397, 0.27502569583536235, 0.2829518308739805, 0.28851396659067446, 0.2845335139996915, 0.2875575191454091, 0.2896436584634852, 0.2951931076511, 0.28525063109798576, 0.29251253976348884, 0.29961042714392333, 0.29000650040362913, 0.2836134658762026, 0.28099404794926497, 0.2652953390850308, 0.26093442436527736, 0.2629754594109904, 0.27001199462526493, 0.2703028757509956, 0.27063969364986634, 0.26679163130679573, 0.27544042800042245, 0.2675009127666626, 0.2593813584763868, 0.2555421682773356, 0.2486230443202166, 0.24463509466931954, 0.2549721740125592, 0.26230221451239516, 0.2564738479719374, 0.25962571323876177, 0.26155687687375134, 0.26103769368449997, 0.2328406325437392, 0.24794481475476615, 0.2410253645260627, 0.24193996122856415, 0.24410175786400357, 0.25193775336214225, 0.25804427999636703, 0.2713844624520962, 0.2729535016821483, 0.2768629090873692, 0.2759296157767804, 0.27088596954608, 0.2776326847342121, 0.27875029707208354, 0.2821120421486612, 0.30089534865576817, 0.30865153579141097, 0.29923166181291316, 0.2895994695662261, 0.293709952097938, 0.29079489783279755, 0.284501719262816, 0.2676877172218885, 0.27106161533297624, 0.2805511569046001, 0.27341098530515395, 0.2747995062637166, 0.277489529254771, 0.2658457848557572, 0.262122771440582, 0.25708701087595787, 0.2546132656151955, 0.243875122746358, 0.23608637094910162), nrow=4, ncol=34, byrow=TRUE )
mydata = matrix( c(0.2, 0.3, 0.4, 0.1, 0.2, 0.3, 0.4, 0.1, 0.1, 0.3, 0.4, 0.2), nrow=4, ncol=3, byrow=TRUE )
rownames(mydata)<-c("A","T","C","G")
print(mydata)

p1 = ggseqlogo( mydata , method="prob")
p1
